{% extends 'base.html' %}

{% block title %}Generate Video - {{ project.title }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Generate Video</h2>
    
    <div class="alert alert-info" role="alert" id="taskStatus">
        <div class="spinner-border spinner-border-sm" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
        <span>Generating video... This may take several minutes. You will be redirected to the home page when complete.</span>
    </div>

    <form method="post" id="generateVideoForm">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary" id="generateBtn">Start Video Generation</button>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const taskStatus = document.getElementById('taskStatus');
    const generateBtn = document.getElementById('generateBtn');
    const generateVideoForm = document.getElementById('generateVideoForm');

    taskStatus.style.display = 'none';

    generateVideoForm.addEventListener('submit', function() {
        generateBtn.disabled = true;
        taskStatus.style.display = 'block';
    });
});
</script>

{% if project.final_video %}
<div class="mt-4">
    <h2>Final Video</h2>
    <video width="100%" controls>
        <source src="{{ project.final_video.url }}" type="video/mp4">
        Your browser does not support the video tag.
    </video>
</div>
{% endif %}
{% endblock %}
